<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Metatags para redes sociais -->
    <meta property="og:image" content="https://github.com/ProsperidadeQuantica/Mapa-Numerologia-Caldeu/blob/main/PROSPERIDADE%20QU%C3%82NTICA%20LOGO.png?raw=true">
    <meta property="og:title" content="Mapa Caldeu de Numerologia Completo">
    <meta property="og:description" content="Descubra seu mapa numerol√≥gico completo com base na numerologia caldeia.">
    <meta property="og:url" content="URL_DO_SEU_SITE_AQUI">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="URL_DA_IMAGEM_LOGO_AQUI">

    <title>Mapa Caldeu de Numerologia Completo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #e8e8e8;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            text-align: center;
            font-size: 2.3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff66b2, #ff8cc6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 25px rgba(255, 105, 180, 0.3);
        }

        .subtitle {
            text-align: center;
            font-size: 1.1em;
            margin-bottom: 40px;
            color: #ff8cc6;
            font-style: italic;
        }

        .input-section, .results-section, .info-section {
            background: rgba(255, 255, 255, 0.03);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        h2 {
            color: #ff66b2;
            margin-bottom: 25px;
            font-size: 1.6em;
            text-align: center;
            border-bottom: 1px solid rgba(255, 105, 180, 0.2);
            padding-bottom: 10px;
        }
        
        h3 {
            color: #ff8cc6;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.3em;
        }
        
        h4 {
             color: #ff8cc6;
             margin-bottom: 8px;
             font-size: 1.1em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #ff8cc6;
            font-weight: bold;
            font-size: 1.1em;
        }

        input[type="text"],
        input[type="date"] {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 105, 180, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.08);
            color: #e8e8e8;
            font-size: 1.1em;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            font-family: 'Georgia', serif;
        }

        input[type="text"]:focus,
        input[type="date"]:focus {
            outline: none;
            border-color: #ff66b2;
            box-shadow: 0 0 15px rgba(255, 105, 180, 0.3);
        }
        
        input[type="date"] {
            appearance: none;
            -webkit-appearance: none;
            position: relative;
            color-scheme: dark;
        }
        
        input[type="date"]::before {
            content: attr(placeholder);
            position: absolute;
            color: #aaa;
            left: 12px;
            top: 12px;
            width: calc(100% - 40px);
        }
        
        input[type="date"]:focus::before, 
        input[type="date"]:valid::before {
             display: none;
        }

        .calculate-button {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #ff66b2, #e64a9f);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .calculate-button:hover {
            background: linear-gradient(45deg, #e64a9f, #ff66b2);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
            transform: translateY(-2px);
        }

        .result-block {
            background: rgba(255, 105, 180, 0.08);
            border: 1px solid rgba(255, 105, 180, 0.2);
            border-left: 5px solid #ff66b2;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .result-number {
            font-size: 2.8em;
            font-weight: bold;
            color: #ff66b2;
            margin-bottom: 5px;
            text-shadow: 0 0 15px rgba(255, 105, 180, 0.4);
        }
        
        .result-compound-number {
             font-size: 1.5em;
             font-weight: bold;
             color: #ff8cc6;
             margin-bottom: 10px;
        }

        .result-calculation {
            color: #c9c9c9;
            margin-bottom: 15px;
            font-size: 1em;
            word-wrap: break-word;
        }

        .interpretation {
            background: rgba(255, 255, 255, 0.04);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .interpretation h4 {
            color: #ff8cc6;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .interpretation p {
            font-size: 1em;
            color: #e0e0e0;
        }

        .chaldean-table-container {
            margin-top: 30px;
        }

        .chaldean-table {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .letter-box {
            background: rgba(255, 105, 180, 0.1);
            border: 1px solid rgba(255, 105, 180, 0.3);
            border-radius: 8px;
            padding: 10px 5px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .letter-box:hover {
            background: rgba(255, 105, 180, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.2);
        }

        .letter {
            font-size: 1.1em;
            font-weight: bold;
            color: #ff66b2;
        }

        .number {
            font-size: 0.9em;
            color: #e8e8e8;
            margin-top: 4px;
        }
        
        .energy-diagram-container {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 105, 180, 0.2);
        }
        
        .energy-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 250px;
            margin: 15px auto;
        }
        
        .energy-cell {
            border: 1px solid rgba(255, 105, 180, 0.3);
            border-radius: 8px;
            padding: 15px 10px;
            text-align: center;
            background: rgba(255, 105, 180, 0.05);
            position: relative;
        }
        
        .energy-number {
            font-size: 1.4em;
            font-weight: bold;
            color: #ff8cc6;
        }
        
        .energy-count {
            font-size: 0.9em;
            color: #aaa;
            margin-top: 5px;
        }
        
        .energy-count-circles {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 2px;
        }
        
        .energy-count-circles span {
            display: inline-block;
            width: 6px;
            height: 6px;
            background-color: #ff66b2;
            border-radius: 50%;
            opacity: 0.7;
        }

        /* Novos estilos para a se√ß√£o de n√∫meros primordiais */
        .primordial-section {
            margin-top: 20px;
        }
        
        .primordial-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .primordial-box {
            background: rgba(255, 105, 180, 0.1);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 105, 180, 0.3);
        }
        
        .primordial-title {
            font-size: 1.1em;
            color: #ff66b2;
            margin-bottom: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .primordial-numbers {
            text-align: center;
            font-size: 1.3em;
            color: #e8e8e8;
            word-wrap: break-word;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 2em;
            }
            h2 {
                font-size: 1.4em;
            }
            .chaldean-table {
                grid-template-columns: repeat(auto-fit, minmax(45px, 1fr));
            }
            .primordial-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
             h1 {
                font-size: 1.8em;
            }
             h2 {
                font-size: 1.3em;
            }
            .result-number {
                font-size: 2.5em;
            }
            .energy-grid {
                 max-width: 200px;
            }
            .energy-cell {
                 padding: 10px 5px;
            }
            .energy-number {
                 font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÆ Mapa Caldeu de Numerologia Completo</h1>
        <p class="subtitle">Descubra as vibra√ß√µes que moldam seu destino</p>

        <!-- Se√ß√£o de Inputs -->
        <div class="input-section">
            <h2>üìä Insira seus Dados</h2>
            <div class="input-group">
                <label for="nameInput">Nome mais usado (ou palavra):</label>
                <input type="text" id="nameInput" placeholder="Ex: Maria Silva (sem acentos)">
                <p style="font-size: 0.8em; color: #ff8cc6; text-align: right; margin-top: 5px;">(N√£o use acentos)</p>
            </div>
            <div class="input-group">
                <label for="dobInput">Data de Nascimento:</label>
                <input type="date" id="dobInput" placeholder="dd/mm/aaaa">
            </div>
             <div class="input-group">
                <label for="fullNameInput">Nome Completo de Nascimento (Legal):</label>
                <input type="text" id="fullNameInput" placeholder="Ex: Maria da Silva Santos (sem acentos)">
                 <p style="font-size: 0.8em; color: #ff8cc6; text-align: right; margin-top: 5px;">(Necess√°rio para An√°lise Energ√©tica)</p>
            </div>
            <button class="calculate-button" onclick="calculateAll()">Calcular Mapa Numerol√≥gico</button>
        </div>

        <!-- Se√ß√£o de Resultados -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <h2>‚ú® Seu Mapa Numerol√≥gico ‚ú®</h2>
            
            <!-- N√∫mero de Destino (Data de Nascimento) -->
            <div id="destinyResult" class="result-block" style="display: none;"></div>
            
            <!-- N√∫mero Primordial e N√∫meros Relacionados -->
            <div id="primordialResult" style="display: none;"></div>

            <!-- N√∫meros do Nome (Express√£o, Alma, Personalidade) -->
            <div id="nameResults" style="display: none;">
                <h3>Numerologia do Nome: <span id="nameUsed"></span></h3>
                <div id="expressionResult" class="result-block"></div>
                <div id="soulUrgeResult" class="result-block"></div>
                <div id="personalityResult" class="result-block"></div>
            </div>

            <!-- An√°lise Energ√©tica (Nome Completo) -->
             <div id="energyAnalysisSection" style="display: none;">
                 <h3>An√°lise Energ√©tica do Nome Completo: <span id="fullNameUsed"></span></h3>
                 <div id="energyAnalysisResult" class="result-block">
                     <!-- O conte√∫do ser√° preenchido pela fun√ß√£o displayEnergyAnalysis -->
                 </div>
            </div>
        </div>
        
        <!-- Se√ß√£o Informativa -->
        <div class="info-section">
            <h2>üìú Sobre a Numerologia Caldeia</h2>
            <div id="educationalContent">
                <p>A Numerologia Caldeia √© um sistema antigo que associa letras a n√∫meros com base em suas vibra√ß√µes sonoras. Acredita-se que ela revela insights profundos sobre a personalidade, o prop√≥sito de vida e os desafios de um indiv√≠duo.</p>
                <h3>Tabela de Correspond√™ncias Caldeia</h3>
                 <div class="chaldean-table-container">
                     <div class="chaldean-table" id="chaldeanTable"></div>
                 </div>
                 <p style="font-size: 0.9em; margin-top: 10px;">Nota: O n√∫mero 9 √© considerado sagrado e n√£o √© atribu√≠do a letras neste sistema, mas pode aparecer como resultado final de um c√°lculo.</p>
                 
                 <div id="moreInfoPlaceholder"></div>
            </div>
        </div>
    </div>

    <script>
        // Tabela Caldeia
        const chaldeanValues = {
            'A': 1, 'B': 2, 'C': 3, 'D': 4, 'E': 5, 'F': 8, 'G': 3, 'H': 5, 'I': 1,
            'J': 1, 'K': 2, 'L': 3, 'M': 4, 'N': 5, 'O': 7, 'P': 8, 'Q': 1, 'R': 2,
            'S': 3, 'T': 4, 'U': 6, 'V': 6, 'W': 6, 'X': 5, 'Y': 1, 'Z': 7
        };
        
        // Tabela Pitag√≥rica (para An√°lise Energ√©tica)
        const pythagoreanValues = {
            'A': 1, 'B': 2, 'C': 3, 'D': 4, 'E': 5, 'F': 6, 'G': 7, 'H': 8, 'I': 9,
            'J': 1, 'K': 2, 'L': 3, 'M': 4, 'N': 5, 'O': 6, 'P': 7, 'Q': 8, 'R': 9,
            'S': 1, 'T': 2, 'U': 3, 'V': 4, 'W': 5, 'X': 6, 'Y': 7, 'Z': 8
        };

        // Dados dos N√∫meros Primordiais
        const primordialData = {
            luckyNumbers: {
                1: [2, 4, 9],
                2: [1, 2, 3, 4, 5, 6, 7, 8, 9],
                3: [2, 3, 6, 8, 9],
                4: [1, 2, 6, 7],
                5: [2, 5, 6, 7, 9],
                6: [2, 3, 4, 5, 6, 9],
                7: [2, 4, 5, 7],
                8: [2, 3, 9],
                9: [1, 2, 3, 5, 6, 8, 9]
            },
            neutralNumbers: {
                1: [1, 5, 6, 8],
                2: [],
                3: [4, 7],
                4: [3, 5, 9],
                5: [1, 4],
                6: [1],
                7: [3, 9],
                8: [1, 6],
                9: [4, 7]
            },
            incompatibleNumbers: {
                1: [3, 7],
                3: [1, 5],
                4: [4, 8],
                5: [3, 8],
                6: [7, 8],
                7: [1, 6, 8],
                8: [4, 5, 7, 8]
            }
        };

        // Interpreta√ß√µes
        const interpretations = {
            destiny: {
                1: "Seu caminho √© de lideran√ßa, independ√™ncia e inova√ß√£o. Voc√™ est√° aqui para ser pioneiro e confiar em sua pr√≥pria for√ßa.",
                2: "Seu caminho envolve coopera√ß√£o, diplomacia e sensibilidade. Voc√™ est√° aqui para aprender a trabalhar em harmonia com os outros e construir pontes.",
                3: "Seu caminho √© de criatividade, comunica√ß√£o e express√£o. Voc√™ est√° aqui para inspirar, alegrar e usar seus talentos art√≠sticos.",
                4: "Seu caminho envolve estabilidade, trabalho √°rduo e organiza√ß√£o. Voc√™ est√° aqui para construir bases s√≥lidas e trazer ordem ao caos.",
                5: "Seu caminho √© de liberdade, aventura e mudan√ßa. Voc√™ est√° aqui para experimentar a vida ao m√°ximo e se adaptar a novas situa√ß√µes.",
                6: "Seu caminho envolve responsabilidade, servi√ßo e cuidado com os outros. Voc√™ est√° aqui para nutrir, proteger e criar harmonia em seus relacionamentos e comunidade.",
                7: "Seu caminho √© de introspec√ß√£o, espiritualidade e busca pelo conhecimento. Voc√™ est√° aqui para explorar os mist√©rios da vida e confiar em sua intui√ß√£o.",
                8: "Seu caminho envolve poder, ambi√ß√£o e sucesso material. Voc√™ est√° aqui para aprender a manifestar seus objetivos no mundo f√≠sico e usar sua autoridade com sabedoria.",
                9: "Seu caminho √© de compaix√£o, humanitarismo e sabedoria universal. Voc√™ est√° aqui para servir a um prop√≥sito maior e inspirar os outros com sua generosidade.",
                11: "N√∫mero Mestre: Seu caminho √© de ilumina√ß√£o espiritual, intui√ß√£o elevada e inspira√ß√£o. Voc√™ est√° aqui para ser um canal de consci√™ncia superior, mas pode enfrentar desafios nervosos.",
                22: "N√∫mero Mestre: Seu caminho √© de constru√ß√£o em larga escala, combinando o idealismo com a praticidade. Voc√™ est√° aqui para manifestar grandes projetos que beneficiem a humanidade.",
                33: "N√∫mero Mestre: Seu caminho √© de mestre curador, compaix√£o universal e servi√ßo abnegado. Voc√™ est√° aqui para elevar a consci√™ncia e aliviar o sofrimento (raro como n√∫mero final de destino)."
            },
            expression: {
                 1: "Voc√™ se expressa com lideran√ßa, originalidade e uma forte vontade. Pioneiro e determinado.",
                 2: "Sua express√£o √© cooperativa, diplom√°tica e gentil. Busca harmonia e parcerias.",
                 3: "Voc√™ se expressa de forma criativa, comunicativa e otimista. Gosta de socializar e inspirar.",
                 4: "Sua express√£o √© pr√°tica, organizada e trabalhadora. Busca seguran√ßa e estabilidade.",
                 5: "Voc√™ se expressa com versatilidade, liberdade e curiosidade. Ama mudan√ßas e novas experi√™ncias.",
                 6: "Sua express√£o √© respons√°vel, protetora e voltada para a comunidade. Busca harmonia e cuidado.",
                 7: "Voc√™ se expressa de forma introspectiva, anal√≠tica e intuitiva. Busca conhecimento e profundidade.",
                 8: "Sua express√£o √© ambiciosa, poderosa e voltada para resultados. Busca sucesso material e autoridade.",
                 9: "Voc√™ se expressa com compaix√£o, idealismo e generosidade. Busca servir a humanidade.",
                 11: "N√∫mero Mestre: Sua express√£o √© inspiradora, intuitiva e carism√°tica. Pode trazer ilumina√ß√£o, mas tamb√©m tens√£o nervosa.",
                 22: "N√∫mero Mestre: Sua express√£o √© a de um construtor mestre, capaz de transformar sonhos em realidade pr√°tica em larga escala.",
                 33: "N√∫mero Mestre: Sua express√£o √© de mestre curador, compassiva e dedicada ao servi√ßo altru√≠sta (raro como n√∫mero de express√£o)."
            },
            compound: {
                10: "Roda da Fortuna: Potencial para sucesso ou queda, dependendo das a√ß√µes. Carrega uma energia k√°rmica de come√ßos e fins.",
                11: "For√ßa Oculta: N√∫mero mestre de grande intui√ß√£o, inspira√ß√£o, mas tamb√©m tens√£o nervosa e prova√ß√µes.",
                12: "O Sacrif√≠cio: Indica ansiedade e sacrif√≠cio pelo bem dos outros. Aprendizado atrav√©s das dificuldades.",
                13: "Transforma√ß√£o: Mudan√ßas inesperadas e transforma√ß√£o. Poder de reconstru√ß√£o ap√≥s a destrui√ß√£o.",
                14: "Movimento e Comunica√ß√£o: Risco em excessos, mas bom para comunica√ß√£o e lidar com pessoas. Magnetismo.",
                15: "O Mago: Eloqu√™ncia, carisma e sorte material, especialmente atrav√©s de presentes ou legados. Cuidado com o lado sombrio.",
                16: "Torre Fulminada: Avisos de perigo, acidentes ou planos frustrados. Necessidade de cautela e planejamento.",
                19: "O Pr√≠ncipe do C√©u: N√∫mero altamente favor√°vel, promete sucesso, felicidade e realiza√ß√£o.",
                22: "O Construtor Mestre: Potencial para grandes realiza√ß√µes que beneficiam muitos, mas exige esfor√ßo e responsabilidade.",
            },
            soul: {
                1: "Sua alma anseia por independ√™ncia, lideran√ßa e ser o n√∫mero um.",
                2: "Sua alma busca harmonia, coopera√ß√£o e relacionamentos pac√≠ficos.",
                3: "Sua alma deseja se expressar criativamente, comunicar e sentir alegria.",
                4: "Sua alma anseia por estabilidade, seguran√ßa e ordem.",
                5: "Sua alma busca liberdade, aventura e variedade na vida.",
                6: "Sua alma deseja responsabilidade, cuidar dos outros e criar um lar harmonioso.",
                7: "Sua alma anseia por conhecimento, introspec√ß√£o e conex√£o espiritual.",
                8: "Sua alma busca poder, sucesso material e controle sobre o ambiente.",
                9: "Sua alma deseja compaix√£o, servir √† humanidade e ter um impacto amplo.",
                11: "N√∫mero Mestre: Sua alma tem um desejo profundo por ilumina√ß√£o espiritual e inspirar os outros.",
                22: "N√∫mero Mestre: Sua alma anseia por construir algo de valor duradouro para o mundo.",
                33: "N√∫mero Mestre: Sua alma tem um forte impulso para curar e servir desinteressadamente (raro)."
            },
            personality: {
                1: "Voc√™ aparenta ser independente, confiante e talvez um pouco autorit√°rio.",
                2: "Voc√™ aparenta ser diplom√°tico, charmoso e cooperativo.",
                3: "Voc√™ aparenta ser soci√°vel, otimista e comunicativo.",
                4: "Voc√™ aparenta ser pr√°tico, confi√°vel e talvez um pouco r√≠gido.",
                5: "Voc√™ aparenta ser aventureiro, magn√©tico e inquieto.",
                6: "Voc√™ aparenta ser respons√°vel, protetor e conselheiro.",
                7: "Voc√™ aparenta ser reservado, misterioso e intelectual.",
                8: "Voc√™ aparenta ser poderoso, bem-sucedido e com controle.",
                9: "Voc√™ aparenta ser carism√°tico, compassivo e um l√≠der inspirador.",
                11: "N√∫mero Mestre: Voc√™ aparenta ser intuitivo, carism√°tico e talvez um pouco tenso ou el√©trico.",
                22: "N√∫mero Mestre: Voc√™ aparenta ser competente, poderoso e capaz de grandes feitos.",
                33: "N√∫mero Mestre: Voc√™ aparenta ser gentil, compassivo e dedicado a ajudar os outros (raro)."
            },
            energy: {
                 general: "A an√°lise energ√©tica mostra a distribui√ß√£o das vibra√ß√µes num√©ricas (1-9) em seu nome completo de nascimento, usando o sistema Pitag√≥rico. Isso revela seus pontos fortes e fracos energ√©ticos inerentes.",
                 lines: "As linhas de energia (a serem implementadas) conectar√£o esses n√∫meros para mostrar como diferentes aspectos (f√≠sico, mental, espiritual) interagem em sua vida."
            },
            primordial: {
                 general: "O N√∫mero Primordial √© calculado a partir do dia do seu nascimento. Ele revela n√∫meros da sorte, neutros e incompat√≠veis que influenciam sua vida.",
                 lucky: "N√∫meros da Sorte: Trazem energia positiva e favorecem suas a√ß√µes quando utilizados conscientemente.",
                 neutral: "N√∫meros Neutros: N√£o trazem benef√≠cios nem preju√≠zos significativos, s√£o neutros em rela√ß√£o ao seu N√∫mero Primordial.",
                 incompatible: "N√∫meros Incompat√≠veis: Podem trazer desafios ou exigir mais aten√ß√£o quando aparecem em sua vida."
            }
        };

        // --- Fun√ß√µes de C√°lculo --- 
        
        function normalizeString(str) {
            if (!str) return '';
            return str.normalize("NFD").replace(/\p{Diacritic}/gu, "").toUpperCase();
        }
        
        function reduceNumber(num, trackSteps = false) {
            let currentNum = num;
            let steps = `${num}`;
            const masterNumbers = [11, 22, 33];

            if (masterNumbers.includes(currentNum)) {
                return trackSteps ? { finalNumber: currentNum, calculationSteps: steps } : currentNum;
            }

            while (currentNum > 9) {
                let digits = currentNum.toString().split('');
                let sum = digits.reduce((acc, digit) => acc + parseInt(digit), 0);
                steps += ` ‚Üí ${digits.join(' + ')} = ${sum}`;
                currentNum = sum;
                if (masterNumbers.includes(currentNum)) {
                    break;
                }
            }
            return trackSteps ? { finalNumber: currentNum, calculationSteps: steps } : currentNum;
        }

        function calculateDestinyNumber(dob) {
            if (!dob) return null;
            try {
                const [year, month, day] = dob.split('-').map(Number);
                if (!year || !month || !day || year < 1000) throw new Error("Data inv√°lida ou ano incompleto.");

                const reducedDayResult = reduceNumber(day, true);
                const reducedMonthResult = reduceNumber(month, true);
                const reducedYearResult = reduceNumber(year, true);

                const compoundNumber = reducedDayResult.finalNumber + reducedMonthResult.finalNumber + reducedYearResult.finalNumber;
                const finalResult = reduceNumber(compoundNumber, true);

                let calculationSteps = 
                    `Dia (${day}): ${reducedDayResult.calculationSteps.substring(reducedDayResult.calculationSteps.indexOf('=') + 1).trim()}<br>
                     M√™s (${month}): ${reducedMonthResult.calculationSteps.substring(reducedMonthResult.calculationSteps.indexOf('=') + 1).trim()}<br>
                     Ano (${year}): ${reducedYearResult.calculationSteps.substring(reducedYearResult.calculationSteps.indexOf('=') + 1).trim()}<br>
                     Soma Reduzida: ${reducedDayResult.finalNumber} + ${reducedMonthResult.finalNumber} + ${reducedYearResult.finalNumber} = ${compoundNumber}`;
                
                if (compoundNumber !== finalResult.finalNumber && ![11, 22, 33].includes(compoundNumber)) {
                     let finalReductionStep = finalResult.calculationSteps.substring(finalResult.calculationSteps.indexOf('‚Üí'));
                     calculationSteps += `<br>Redu√ß√£o Final: ${compoundNumber} ${finalReductionStep}`;
                }

                return {
                    finalNumber: finalResult.finalNumber,
                    calculationSteps: calculationSteps,
                    compoundNumber: compoundNumber,
                    day: day
                };
            } catch (error) {
                console.error("Erro ao calcular n√∫mero do destino:", error);
                alert("Formato de data inv√°lido. Use AAAA-MM-DD.");
                return null;
            }
        }

        function calculatePrimordialNumber(day) {
            if (!day) return null;
            
            const primordialResult = reduceNumber(day, true);
            const primordialNumber = primordialResult.finalNumber;
            
            let luckyNumbers = primordialData.luckyNumbers[primordialNumber] || [];
            let neutralNumbers = primordialData.neutralNumbers[primordialNumber] || [];
            let incompatibleNumbers = primordialData.incompatibleNumbers[primordialNumber] || [];
            
            // Para o n√∫mero 2, todos s√£o da sorte e n√£o h√° incompat√≠veis
            if (primordialNumber === 2) {
                luckyNumbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];
                incompatibleNumbers = [];
            }
            
            // Para o n√∫mero 9, n√£o h√° incompat√≠veis
            if (primordialNumber === 9) {
                incompatibleNumbers = [];
            }
            
            return {
                primordialNumber: primordialNumber,
                calculationSteps: primordialResult.calculationSteps,
                luckyNumbers: luckyNumbers,
                neutralNumbers: neutralNumbers,
                incompatibleNumbers: incompatibleNumbers
            };
        }

        function calculateNameNumber(name, valueMap, filterType = 'all') {
            if (!name) return null;
            let total = 0;
            let calculation = [];
            const vowels = 'AEIOU';
            
            for (let char of name) {
                let includeChar = false;
                if (filterType === 'all' && valueMap[char]) {
                    includeChar = true;
                } else if (filterType === 'vowels' && vowels.includes(char) && valueMap[char]) {
                    includeChar = true;
                } else if (filterType === 'consonants' && !vowels.includes(char) && valueMap[char]) {
                    includeChar = true;
                }

                if (includeChar) {
                    total += valueMap[char];
                    calculation.push(`${char}(${valueMap[char]})`);
                }
            }

            if (calculation.length === 0) {
                 return null;
            }

            const compoundNumber = total;
            const finalResult = reduceNumber(compoundNumber, true);
            let calculationSteps = calculation.join(' + ');
            
            if (compoundNumber !== finalResult.finalNumber) {
                 let finalReductionStep = finalResult.calculationSteps.substring(finalResult.calculationSteps.indexOf('‚Üí'));
                 calculationSteps += `<br>Soma Total = ${compoundNumber} ${finalReductionStep ? finalReductionStep : ''}`;
            } else {
                 calculationSteps += ` = ${compoundNumber}`;
            }

            return {
                finalNumber: finalResult.finalNumber,
                calculationSteps: calculationSteps,
                compoundNumber: compoundNumber
            };
        }

        function calculateExpressionNumber(name) {
            return calculateNameNumber(name, chaldeanValues, 'all');
        }

        function calculateSoulUrgeNumber(name) {
            return calculateNameNumber(name, chaldeanValues, 'vowels');
        }

        function calculatePersonalityNumber(name) {
            return calculateNameNumber(name, chaldeanValues, 'consonants');
        }
        
        function calculateEnergyAnalysis(fullName) {
             if (!fullName) return null;
             const name = normalizeString(fullName);
             let counts = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0 };
             let totalLetters = 0;

             for (let char of name) {
                 if (pythagoreanValues[char]) {
                     counts[pythagoreanValues[char]]++;
                     totalLetters++;
                 }
             }
             
             if (totalLetters === 0) return null;

             let lineAnalysisText = interpretations.energy.lines || "(An√°lise das linhas ser√° implementada)";

             return {
                 diagramData: counts,
                 lineAnalysis: lineAnalysisText,
                 interpretation: interpretations.energy.general || "(Interpreta√ß√£o geral da energia ser√° implementada)"
             };
        }

        // --- Fun√ß√µes de Exibi√ß√£o --- 
        
        function displayResult(elementId, title, numberData, interpretationData) {
            const container = document.getElementById(elementId);
            if (!container) return;
            
            if (!numberData) {
                container.style.display = 'none';
                container.innerHTML = '';
                return;
            }
            
            let finalInterpretationText = interpretationData[numberData.finalNumber] || "Interpreta√ß√£o para este n√∫mero final ainda n√£o dispon√≠vel.";
            let compoundInterpretationText = interpretations.compound[numberData.compoundNumber] || "";

            container.innerHTML = `
                <h3>${title}</h3>
                ${numberData.compoundNumber && numberData.compoundNumber !== numberData.finalNumber ? 
                    `<div class="result-compound-number">N√∫mero Composto: ${numberData.compoundNumber}</div>` : ''}
                <div class="result-number">${numberData.finalNumber}</div>
                <div class="result-calculation"><strong>C√°lculo:</strong><br>${numberData.calculationSteps}</div>
                <div class="interpretation">
                    ${compoundInterpretationText ? `<h4>Interpreta√ß√£o (Composto ${numberData.compoundNumber}):</h4><p>${compoundInterpretationText}</p><hr style='margin: 10px 0; border-color: rgba(255, 105, 180, 0.2);'>` : ''}
                    <h4>Interpreta√ß√£o (Final ${numberData.finalNumber}):</h4>
                    <p>${finalInterpretationText}</p>
                </div>
            `;
            container.style.display = 'block';
        }
        
        function displayPrimordialResult(day) {
            const container = document.getElementById('primordialResult');
            if (!container) return;
            
            if (!day) {
                container.style.display = 'none';
                container.innerHTML = '';
                return;
            }
            
            const primordialData = calculatePrimordialNumber(day);
            if (!primordialData) {
                container.style.display = 'none';
                return;
            }
            
            container.innerHTML = `
                <div class="result-block">
                    <h3>üî¢ N√∫mero Primordial (Dia ${day})</h3>
                    <div class="result-number">${primordialData.primordialNumber}</div>
                    <div class="result-calculation"><strong>C√°lculo:</strong><br>${primordialData.calculationSteps}</div>
                    <div class="interpretation">
                        <h4>Interpreta√ß√£o:</h4>
                        <p>${interpretations.primordial.general}</p>
                    </div>
                    <div class="primordial-section">
                        <div class="primordial-grid">
                            <div class="primordial-box">
                                <div class="primordial-title">N√∫meros da Sorte</div>
                                <div class="primordial-numbers">${primordialData.luckyNumbers.join(', ')}</div>
                                <p style="font-size: 0.9em; margin-top: 10px; text-align: center;">${interpretations.primordial.lucky}</p>
                            </div>
                            <div class="primordial-box">
                                <div class="primordial-title">N√∫meros Neutros</div>
                                <div class="primordial-numbers">${primordialData.neutralNumbers.length > 0 ? primordialData.neutralNumbers.join(', ') : 'Nenhum'}</div>
                                <p style="font-size: 0.9em; margin-top: 10px; text-align: center;">${interpretations.primordial.neutral}</p>
                            </div>
                            <div class="primordial-box">
                                <div class="primordial-title">N√∫meros Incompat√≠veis</div>
                                <div class="primordial-numbers">${primordialData.incompatibleNumbers.length > 0 ? primordialData.incompatibleNumbers.join(', ') : 'Nenhum'}</div>
                                <p style="font-size: 0.9em; margin-top: 10px; text-align: center;">${interpretations.primordial.incompatible}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            container.style.display = 'block';
        }
        
        function displayEnergyAnalysis(elementId, analysisData) {
            const container = document.getElementById(elementId);
             if (!container) return;
             
             if (!analysisData || !analysisData.diagramData || Object.values(analysisData.diagramData).every(count => count === 0)) {
                 container.style.display = 'none';
                 container.innerHTML = '';
                 return;
             }
            
            let gridHtml = '<div class="energy-grid">';
            const gridOrder = [1, 2, 3, 4, 5, 6, 7, 8, 9]; 
            for (let num of gridOrder) {
                const count = analysisData.diagramData[num] || 0;
                let circlesHtml = '';
                const maxCircles = 5; 
                for(let i = 0; i < Math.min(count, maxCircles); i++) {
                    circlesHtml += '<span></span>';
                }
                if (count > maxCircles) circlesHtml += '...';
                
                gridHtml += `
                    <div class="energy-cell">
                        <div class="energy-number">${num}</div>
                        <div class="energy-count">(${count}x)</div>
                        <div class="energy-count-circles">${circlesHtml}</div>
                    </div>
                `;
            }
            gridHtml += '</div>';

            container.innerHTML = `
                 <h4>Diagrama de Energia (Frequ√™ncia 1-9)</h4>
                 <div class="energy-diagram-container">
                     ${gridHtml}
                 </div>
                 <div id="energyInterpretation" class="interpretation">
                     <h4>An√°lise Energ√©tica:</h4>
                     <p>${analysisData.interpretation || 'An√°lise detalhada ser√° implementada.'}</p>
                 </div>
                 <div id="energyLinesAnalysis" class="interpretation">
                     <h4>An√°lise das Linhas:</h4>
                     <p>${analysisData.lineAnalysis || 'An√°lise das linhas ser√° implementada.'}</p>
                 </div>
            `;
             container.style.display = 'block';
        }

        // --- Fun√ß√£o Principal --- 

        function calculateAll() {
            const nameInput = document.getElementById('nameInput').value;
            const dobInput = document.getElementById('dobInput').value;
            const fullNameInput = document.getElementById('fullNameInput').value;
            const resultsSection = document.getElementById('resultsSection');
            const nameResultsSection = document.getElementById('nameResults');
            const energySection = document.getElementById('energyAnalysisSection');
            const destinyResultContainer = document.getElementById('destinyResult');
            const primordialResultContainer = document.getElementById('primordialResult');
            const expressionResultContainer = document.getElementById('expressionResult');
            const soulResultContainer = document.getElementById('soulUrgeResult');
            const personalityResultContainer = document.getElementById('personalityResult');
            const energyAnalysisResultContainer = document.getElementById('energyAnalysisResult');

            if (!nameInput.trim() && !dobInput && !fullNameInput.trim()) {
                alert("Por favor, preencha pelo menos um campo para calcular.");
                resultsSection.style.display = 'none';
                return;
            }

            resultsSection.style.display = 'block';
            destinyResultContainer.style.display = 'none'; 
            primordialResultContainer.style.display = 'none';
            nameResultsSection.style.display = 'none'; 
            expressionResultContainer.style.display = 'none';
            soulResultContainer.style.display = 'none';
            personalityResultContainer.style.display = 'none';
            energySection.style.display = 'none';
            energyAnalysisResultContainer.style.display = 'none';

            if (dobInput) {
                const destinyData = calculateDestinyNumber(dobInput);
                 if (destinyData) {
                    displayResult('destinyResult', 'üåü N√∫mero do Destino (Caminho de Vida)', destinyData, interpretations.destiny);
                    displayPrimordialResult(destinyData.day);
                 } else {
                     destinyResultContainer.innerHTML = '<p style="color: #ff8cc6; text-align: center;">Data de nascimento inv√°lida. Use o formato AAAA-MM-DD.</p>';
                     destinyResultContainer.style.display = 'block';
                 }
            } 

            if (nameInput.trim()) {
                const normalizedName = normalizeString(nameInput);
                document.getElementById('nameUsed').textContent = `"${nameInput}"`;
                nameResultsSection.style.display = 'block';
                
                const expressionData = calculateExpressionNumber(normalizedName);
                const soulData = calculateSoulUrgeNumber(normalizedName);
                const personalityData = calculatePersonalityNumber(normalizedName);
                
                displayResult('expressionResult', ' EXPRESS√ÉO (Como voc√™ age)', expressionData, interpretations.expression);
                displayResult('soulUrgeResult', 'üíñ Impulso da Alma (O que te motiva)', soulData, interpretations.soul);
                displayResult('personalityResult', 'üé≠ Eu Exterior (Como te veem)', personalityData, interpretations.personality);
            }

            if (fullNameInput.trim()) {
                const normalizedFullName = normalizeString(fullNameInput);
                 document.getElementById('fullNameUsed').textContent = `"${fullNameInput}"`;
                const energyData = calculateEnergyAnalysis(normalizedFullName);
                displayEnergyAnalysis('energyAnalysisResult', energyData); 
                energySection.style.display = 'block';
            }
            
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        // --- Inicializa√ß√£o --- 
        function createChaldeanTable() {
            const table = document.getElementById('chaldeanTable');
            if (!table) return;
            table.innerHTML = '';
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            for (let letter of alphabet) {
                if (chaldeanValues[letter]) {
                    const letterBox = document.createElement('div');
                    letterBox.className = 'letter-box';
                    letterBox.innerHTML = `
                        <div class="letter">${letter}</div>
                        <div class="number">${chaldeanValues[letter]}</div>
                    `;
                    table.appendChild(letterBox);
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
             createChaldeanTable();
        });
    </script>
</body>
</html>
